<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
    <link rel="stylesheet" href="css/bootstrap.css"/>
    <link rel="stylesheet" href="css/user_register.css"/>
    <script src="js/jquery.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <title></title>
</head>
<body>
<header class="header ">
    <div class="float-left">
        <div class="topi">
            <a href="#"> <img src="img/logo.png"/></a>
        </div>
    </div>`
    <div class="top">
        <ul class="list-unstyled">
            <div class=" d-flex tnav">
            <li><a href="index.html" id="a1">首页</a></li>
            <li><a href="#" id="a2">账号管理</a></li>
            <li><a href="#">快速充值</a></li>
            <li><a href="#">客服中心</a></li></div>
        </ul>
    </div>
    <div class="top">
        <div class="topl">
            <div class="login"></div>
            <a href="#">登陆</a>
            <div class="register"></div>
            <a href="#">注册</a>
        </div>
    </div>

</header>
<div class=" zb">
    <div class="zc">
        <form action="/user/register" method="post">
            <table>
                <tr>
                    <td>账号：</td>
                    <td><input type="text" id="uname" name="uname" onblur="checkUname()" onfocus="funame()"/></td>
                    <td><span id="showUname"></span></td>
                </tr>
                <tr>
                    <td>关联手机：</td>
                    <td><input type="text" id="phone" name="phone" onblur="checkPhone() " onfocus="fphone()"/></td>
                    <td><span id="showPhone"></span></td>
                </tr>
                <tr>
                    <td></td>
                    <td colspan="2" id="td1">每个手机号码仅可绑定10个雷霆账号。若关联手机绑定时提示超出上限，请使用其它手机号进行认证。</td>
                </tr>
                <tr>
                    <td>设置密码：</td>
                    <td><input type="password" id="upwd" name="upwd" onblur="checkUpwd()" onfocus="fupwd()"/></td>
                    <td><span id="showUpwd"></span></td>
                </tr>
                <tr>
                    <td>确认密码：</td>
                    <td><input type="password" id="cpwd" name="cpwd" onblur="checkCpwd()"/></td>
                    <td><span id="showCpwd"></span></td>
                </tr>
                <tr>
                    <td id="td3">
                        身份认证信息:
                    </td>
                    <td colspan="2" id="td2">
                        身份证信息是您帐号安全的重要保证，为了安全请您认真填写。
                    </td>
                </tr>
                <tr>
                    <td>真实姓名：</td>
                    <td><input type="text" id="rname" name="rname" onblur="checkRname()" onfocus="frname()"/></td>
                    <td><span id="showRname"></span></td>
                </tr>
                <tr>
                    <td>身份证号码：</td>
                    <td><input type="text" id="idcard" name="idcard" onblur="checkIdcard()" onfocus="fidcard()"/></td>
                    <td><span id="showIdcard"></span></td>
                </tr>
                <tr>
                    <td></td>
                    <td colspan="2" id="td4">
                        <input type="checkbox" name="terms" id="read"/><label for="read">我已看过并同意</label><a href="#">《雷霆通行证服务条款》</a>
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td colspan="2"><input type="submit" value="确认" id="sub"/></td>
                </tr>
            </table>
        </form>
    </div>
</div>
<footer>
    <div class="clearfix" id="fd1">
        <div class="float-left" id="fd2">
             <img src="img/f_logo.png"/>
        </div>
        <div class="float-left" id="fd3">
            <p>
                <ul class="list-unstyled d-flex">
                    <li><a href="#">关于我们</a> |</li>
                    <li><a href="#">&nbsp;家长监护</a> |</li>
                    <li><a href="#">&nbsp;纠纷处理</a> |</li>
                    <li><a href="#">&nbsp;联系客服</a></li>
                </ul>
            </p>

            <p class="fp">
                健康游戏公告: 抵制不良游戏 拒绝盗版游戏 注意自我保护 谨防受骗上当 适度游戏益脑 沉迷游戏伤身 合理安排时间 享受健康生活
            </p>
            <p>
                ICP证闽B2-20130030 | 闽网文〔2017〕10835-338号 | 新出网证(闽)字14号 | 闽ICP备12001243号-4
                <a href="#"><img src="img/wenhua.png"/></a>
            </p>
            <p>
                Copyright © 2004-2018
                <a href="#">吉比特网络</a>
                <a href="#">雷霆游戏</a>
                <a href="#"> 版权所有</a>
                <a href="#"><img src="img/mingongwanganbei.png"/></a>
                <a href="#">闽公网安备 35020302001361号</a>
            </p>
        </div>
    </div>
</footer>
    <script src="./js/common.js"></script>
    <script>
        function funame(){
            $("showUname").innerHTML="账号至少3个字符，最多32个字符";
            $("showUname").style.backgroundColor="#E9F0FF";
        }
        function fphone(){
            $("showPhone").innerHTML="手机账号必须是11位";
             $("showPhone").style.backgroundColor="#E9F0FF";
        }
        function fupwd(){
            $("showUpwd").innerHTML="请输入6-32位数字或字母或下划线";
            $("showUpwd").style.backgroundColor="#E9F0FF";
        }
        function frname(){
            $("showRname").innerHTML="请输入您的真实姓名";
            $("showRname").style.backgroundColor="#E9F0FF";
        }
        function fidcard(){
            $("showIdcard").innerHTML="请输入18位的身份证";
            $("showIdcard").style.backgroundColor="#E9F0FF";
        }
        function checkUname(){
            if($("uname").value.search(/.{3,32}/)!=-1){
                var xhr=createXhr();
                xhr.onreadystatechange=function(){
                    if(xhr.readyState==4&&xhr.status==200){
                        var res=xhr.responseText;
                        if(res==1){
                            $("showUname").innerHTML="用户可用";
                            $("showUname").style.backgroundColor="#E9FFEB";
                            return;
                        }else if(res==0){
                            $("showUname").innerHTML="用户名已存在";
                            $("showUname").style.backgroundColor="#FFF2E9";
                            return;
                        }else{
                            $("showUname").innerHTML=res;
                        }
                    }
                }
                var uname=$('uname').value;
                xhr.open("get","/user/checkUname?uname="+uname,true);
                xhr.send(null);
            }else{
                $("showUname").innerHTML="您输入账号格式不正确，请重新输入";
                $("showUname").style.backgroundColor="#FFF2E9";
            }
        }

        function checkPhone(){
            if($("phone").value.search(/1[3-8]\d{9}/)!=-1){
                var xhr=createXhr();
                xhr.onreadystatechange=function(){
                    if(xhr.readyState==4&&xhr.status==200){
                        var res=xhr.responseText;
                        $("showPhone").innerHTML=res;
                    }
                };
                var phone=$('phone').value;
                xhr.open("get","/user/checkPhone?phone="+phone,true);
                xhr.send(null);
            }else{
                $("showPhone").innerHTML="请输入正确格式的手机号码";
                $("showPhone").style.backgroundColor="#FFF2E9";
            }
        }
        function checkUpwd(){
            if($("upwd").value.search(/(\d|\w|_){6,32}/)!=-1){
                $("showUpwd").innerHTML="输入正确";
                $("showUpwd").style.backgroundColor="#E9FFEB";
            }else{
                $("showUpwd").innerHTML="请输入正确格式的密码";
                $("showUpwd").style.backgroundColor="#FFF2E9";
            }
        }
        function checkCpwd(){
            if($("cpwd").value==$("upwd").value){
                $('showCpwd').innerHTML="密码一致";
                $("showCpwd").style.backgroundColor="#E9FFEB";
            }else{
                $('showCpwd').innerHTML="密码错误";
                $("showCpwd").style.backgroundColor="#FFF2E9";
            }
        }
        function checkIdcard(){
            if($("idcard").value.search(/\d{15}(\d{2}[0-9Xx])?/)!=-1){
                $("showIdcard").innerHTML="输入正确";
                $("showIdcard").style.backgroundColor="#E9FFEB";
            }else{
                $("showIdcard").innerHTML="您输入的身份证号码长度或格式错误";
                $("showIdcard").style.backgroundColor="#FFF2E9";
            }
        }
        function register(){
                var xhr=createXhr();
                xhr.onreadystatechange=function(){
                    if(xhr.readyState==4&&xhr.status==200){
                        var res=xhr.responseText;
                        alert(res);
                    }
                }
                xhr.open("post","/user/register",true);
                xhr.setRequestHeader("content-Type","application/x-www-form-urlencoded");
                var uname=$('uname').value;
                var upwd=$('upwd').value;
                var rname=$('rname').value;
                var phone=$('phone').value;
                var idcard=$('idcard').value;
                var url="uname="+uname+"&upwd="+upwd+"&rname="+rname+"&phone="+phone+"&idcard="+idcard;
                xhr.send(url);
        }
    </script>
</body>
</html>